<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo List Typescript</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div class="container" id="app">
      <div class="row justify-content-center align-items-center main-row">
        <div class="col shadow main-col bg-white">
          <div class="row bg-primary text-white">
            <div class="col p-2">
              <h4>Todo App</h4>
            </div>
          </div>
          <div class="row justify-content-between text-white p-2">
            <div class="form-group flex-fill mb-2">
              <input id="todo-input" type="text" class="form-control" v-model="taskTitle" />
            </div>
            <button type="button" @click="createTask" class="btn btn-primary mb-2 ml-2">Add todo</button>
          </div>
          <div class="row" id="todo-container">
            <div class="col col-12 p-2 todo-item" v-for="(item, index) in tasks">
              <div class="input-group">
                <div class="input-group-prepend">
                  <div class="form-control">
                    <input type="checkbox" @change="changeCheckbox(item.id)" />
                  </div>
                </div>
                <input
                  type="text"
                  class="form-control"
                  v-model="tasks[index].title"
                  v-on:keyup.enter="updateTask(item, index)"
                  aria-label="Text input with
                checkbox"
                />
                <div class="bg-secondary text-white btn">{{ item.complete ? 'done' : 'undone' }}</div>
                <div class="input-group-append">
                  <button
                    class="btn btn-outline-secondary bg-danger text-white"
                    type="button"
                    @click="deleteTask(item.id)"
                    id="button-addon2 "
                  >
                    X
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    var exports = {}
  </script>
  <script src="dist/index.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script>
    var vm = new Vue({
      el: '#app',
      data: {
        tasks: taskModel.getAllTasks,
        update: false,
        taskTitle: '',
      },
      computed: {
        getAll() {
          this.tasks = taskModel.getAllTasks
          return taskModel.getAllTasks
        },
      },
      methods: {
        createTask() {
          taskModel.setTask = {
            id: taskModel.getAllTasks.at(-1).id + 1,
            title: this.taskTitle,
            complete: false,
          }
          this.taskTitle = ''
        },
        changeCheckbox(id) {
          this.update = !this.update
          taskModel.updateComplete(id, this.update)
        },
        deleteTask(id) {
          taskModel.deleteTask = id
        },
        updateTask(task, index) {
          taskModel.updateTask = {
            id: task.id,
            title: this.tasks[index].title,
            complete: task.complete,
          }
        },
      },
    })
  </script>
</html>
